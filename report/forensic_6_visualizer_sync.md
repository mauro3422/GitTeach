# Forensic Audit Report: Canvas Visualizer Sync

## Executive Summary
This report analyzes the synchronization between the real processing engine and the Canvas Visualizer in GitTeach. The audit identifies gaps in event-node mapping, missing connections, and areas for improvement in the visualization system.

## 1. PIPELINE_NODES Inventory

### Input Stage
- `data_source`: GitHub - Detects user repositories
- `api_fetch`: API Fetch - Downloads file trees using GitHub API
- `cache`: Cache Store - Stores downloaded files locally with checksums

### Classification Stage
- `auditor`: Content Auditor - Classifies files for deep AI analysis
- `discard_bin`: Discarded - Files filtered out by classifier

### Worker Stage
- `workers_hub`: Worker Hub - Queue manager distributing files to workers
- `worker_1`: Slot 1 - Worker GPU analyzing files with local AI
- `worker_2`: Slot 2 - Worker GPU analyzing files with local AI
- `worker_3`: Slot 3 - Worker GPU analyzing files with local AI

### Processing Stage
- `mixing_buffer`: Evidence Mixer - Joins skeleton metadata with AI findings
- `mappers`: Mappers - Thematic analysis (Architecture, Habits, Stack)
- `compaction`: Compaction - Condenses findings every 10 files

### Synthesis Stage
- `dna_synth`: DNA Synth - Builds developer profile from thematic analyses
- `intelligence`: Intelligence - Evolves DNA to technical identity
- `persistence`: Persistence - LevelDB storage for all outputs

### Tech Radar Satellites
- `radar_adopt`: Adopt - Technologies to adopt
- `radar_trial`: Trial - Technologies to trial
- `radar_assess`: Assess - Technologies to assess
- `radar_hold`: Hold - Technologies to hold

## 2. EVENT_NODE_MAP Mappings

| Event Prefix | Mapped Node |
|--------------|-------------|
| `api:fetch` | `api_fetch` |
| `cache:store` | `cache` |
| `file:classified` | `auditor` |
| `file:discarded` | `discard_bin` |
| `file:queued` | `workers_hub` |
| `worker:slot:1` | `worker_1` |
| `worker:slot:2` | `worker_2` |
| `worker:slot:3` | `worker_3` |
| `ai:cpu:` | `mappers` |
| `mapper:` | `mappers` |
| `compaction:` | `compaction` |
| `file:analyzed` | `mixing_buffer` |
| `file:skeletonized` | `mixing_buffer` |
| `streaming:` | `mixing_buffer` |
| `dna:` | `dna_synth` |
| `synthesis:` | `intelligence` |
| `persist:` | `persistence` |
| `profile:` | `intelligence` |
| `repo:batch` | `workers_hub` |
| `repo:detected` | `cache` |
| `repo:tree:fetched` | `cache` |
| `repo:files:extracting` | `auditor` |
| `repo:complete` | `cache` |
| `file:cache:hit` | `mixing_buffer` |
| `hub:circuit:open` | `workers_hub` |
| `hub:circuit:closed` | `workers_hub` |
| `pipeline:resurrection` | `mixing_buffer` |
| `mixer:gate:` | `mixing_buffer` |
| `system:reaction` | `intelligence` |
| `dna:radar:` | `intelligence` |

## 3. Missing Event-Node Mappings (Real Engine Events NOT Mapped to Canvas)

Based on analysis of PipelineEventBus.js, the following events are generated by the real engine but are NOT mapped to canvas nodes:

- `embedding:start` → No node mapping
- `embedding:end` → No node mapping
- `ai:gpu:start` → No node mapping
- `ai:gpu:end` → No node mapping
- `file:queued` → Partial mapping (mapped to workers_hub but should also map to worker slots)
- `file:completed` → No node mapping

## 4. Canvas Nodes with NO Corresponding Events

The following canvas nodes have NO corresponding events in the real engine:

- `radar_adopt` - No specific events trigger this node
- `radar_trial` - No specific events trigger this node
- `radar_assess` - No specific events trigger this node
- `radar_hold` - No specific events trigger this node
- `discard_bin` - Events exist but may not be properly visualized
- `data_source` - No specific events trigger this node

## 5. BLIND SPOTS: Ghost Nodes and Missing Connections

### Ghost Nodes
- **Radar Nodes**: The satellite nodes (`radar_adopt`, `radar_trial`, `radar_assess`, `radar_hold`) appear to be visual-only elements with no corresponding real engine events. They are only triggered by the `dna:radar:update` event which maps to the `intelligence` node.
- **Data Source Node**: The `data_source` node appears to have no direct triggering events in the current mapping.

### Missing Connections
- **AI GPU Processing**: No visualization for GPU-based AI processing events (`ai:gpu:start/end`)
- **Embedding Generation**: No visualization for embedding generation events (`embedding:start/end`)
- **File Completion**: No visualization for file completion events (`file:completed`)
- **Dynamic Repo Slots**: The dynamic repository slots created during runtime are not reflected in the static node definitions

## 6. IMPROVEMENTS NEEDED

### New Mapper Slots
- Add dedicated visualization for AI GPU processing with a new node (e.g., `ai_gpu_processor`)
- Create specific nodes for embedding generation (e.g., `embedding_generator`)

### CPU Sector
- Add a dedicated CPU processing visualization sector to complement the existing GPU workers
- Create a `cpu_analyzer` node to visualize CPU-intensive tasks

### Missing Animations
- Implement animations for the radar satellite nodes to show technology radar updates
- Add animation for the `discard_bin` to visualize discarded files
- Create animation for the `data_source` node to show repository detection
- Add circuit breaker animations for `hub:circuit:open/closed` events

### Additional Improvements
- Add event mappings for `embedding:start/end` to a new embedding node
- Add event mappings for `ai:gpu:start/end` to a GPU processing node
- Create dynamic visualization for the dynamic repository slots
- Add connection visualization for the bypass mechanism (`file:cache:hit`)
- Improve visualization for the emergency lane (`pipeline:resurrection`)

## Gap Analysis Table

| Category | Issue | Impact | Priority |
|----------|-------|--------|----------|
| Event Mapping | Missing `embedding:start/end` mapping | Embedding process invisible | High |
| Event Mapping | Missing `ai:gpu:start/end` mapping | GPU processing invisible | High |
| Event Mapping | Missing `file:completed` mapping | Completion not visualized | Medium |
| Visualization | Radar nodes lack dedicated events | Satellite visualization incomplete | Medium |
| Visualization | Data source node lacks events | Repository detection not shown | Medium |
| Visualization | Dynamic repo slots not visualized | Runtime slot creation hidden | High |
| Animation | Missing circuit breaker visuals | Error states not animated | Medium |
| Architecture | No dedicated CPU sector | CPU processing not differentiated | Low |

## Conclusion
The Canvas Visualizer has significant blind spots in representing the real processing engine. Key areas for improvement include adding GPU processing visualization, embedding generation visualization, and proper event mappings for all processing stages. The radar satellite nodes need dedicated event handling, and dynamic repository slots need visualization to accurately reflect the real engine state.